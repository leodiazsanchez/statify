{"ast":null,"code":"import { redirectToAuthCodeFlow, getAccessToken } from \"./authCodeWithPkce\";\nconst clientId = \"e5f9bfa9d40447488e4fc74d2c71d293\";\nconst params = new URLSearchParams(window.location.search);\nexport let code = params.get(\"code\");\nlet profile = null;\nexport async function checkAuth() {\n  if (code) {\n    const accessToken = await getAccessToken(clientId, code);\n    profile = await fetchProfile(accessToken);\n    sessionStorage.setItem(\"profile\", JSON.stringify(profile));\n    console.log(\"auth\");\n  }\n  //populateUI(profile);\n}\nexport async function handleLogin() {\n  if (!code) {\n    redirectToAuthCodeFlow(clientId);\n  }\n}\nexport function handleLogout() {\n  localStorage.removeItem(\"verifier\");\n  localStorage.removeItem(\"access_token\"); // If you store access token in localStorage\n  code = null;\n  window.location.href = '/'; // Redirect to homepage or login page\n}\nasync function fetchProfile(token) {\n  const result = await fetch(\"https://api.spotify.com/v1/me\", {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  return await result.json();\n}\nfunction populateUI(profile) {\n  console.log(profile.display_name);\n  document.getElementById(\"displayName\").innerText = profile.display_name;\n}","map":{"version":3,"names":["redirectToAuthCodeFlow","getAccessToken","clientId","params","URLSearchParams","window","location","search","code","get","profile","checkAuth","accessToken","fetchProfile","sessionStorage","setItem","JSON","stringify","console","log","handleLogin","handleLogout","localStorage","removeItem","href","token","result","fetch","method","headers","Authorization","json","populateUI","display_name","document","getElementById","innerText"],"sources":["C:/Users/Leo/Documents/learningts/my-app/src/scripts/auth.ts"],"sourcesContent":["import { redirectToAuthCodeFlow, getAccessToken } from \"./authCodeWithPkce\";\r\n\r\nconst clientId = \"e5f9bfa9d40447488e4fc74d2c71d293\";\r\nconst params = new URLSearchParams(window.location.search);\r\nexport let code = params.get(\"code\");\r\nlet profile = null;\r\n\r\nexport async function checkAuth() {\r\n    if (code){\r\n        const accessToken = await getAccessToken(clientId, code);\r\n        profile = await fetchProfile(accessToken);\r\n        sessionStorage.setItem(\"profile\", JSON.stringify(profile))\r\n        console.log(\"auth\")\r\n    }\r\n    //populateUI(profile);\r\n}\r\n\r\nexport async function handleLogin() {\r\n    if (!code) {\r\n        redirectToAuthCodeFlow(clientId);\r\n    }\r\n}\r\n\r\nexport function handleLogout() {\r\n    localStorage.removeItem(\"verifier\");\r\n    localStorage.removeItem(\"access_token\"); // If you store access token in localStorage\r\n    code = null;\r\n    window.location.href = '/'; // Redirect to homepage or login page\r\n}\r\n\r\n\r\nasync function fetchProfile(token: string): Promise<any> {\r\n    const result = await fetch(\"https://api.spotify.com/v1/me\", {\r\n        method: \"GET\", headers: { Authorization: `Bearer ${token}` }\r\n    });\r\n\r\n    return await result.json();\r\n}\r\n\r\nfunction populateUI(profile: UserProfile) {\r\n    console.log(profile.display_name)\r\n    document.getElementById(\"displayName\")!.innerText = profile.display_name;\r\n}"],"mappings":"AAAA,SAASA,sBAAsB,EAAEC,cAAc,QAAQ,oBAAoB;AAE3E,MAAMC,QAAQ,GAAG,kCAAkC;AACnD,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;AAC1D,OAAO,IAAIC,IAAI,GAAGL,MAAM,CAACM,GAAG,CAAC,MAAM,CAAC;AACpC,IAAIC,OAAO,GAAG,IAAI;AAElB,OAAO,eAAeC,SAASA,CAAA,EAAG;EAC9B,IAAIH,IAAI,EAAC;IACL,MAAMI,WAAW,GAAG,MAAMX,cAAc,CAACC,QAAQ,EAAEM,IAAI,CAAC;IACxDE,OAAO,GAAG,MAAMG,YAAY,CAACD,WAAW,CAAC;IACzCE,cAAc,CAACC,OAAO,CAAC,SAAS,EAAEC,IAAI,CAACC,SAAS,CAACP,OAAO,CAAC,CAAC;IAC1DQ,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC;EACvB;EACA;AACJ;AAEA,OAAO,eAAeC,WAAWA,CAAA,EAAG;EAChC,IAAI,CAACZ,IAAI,EAAE;IACPR,sBAAsB,CAACE,QAAQ,CAAC;EACpC;AACJ;AAEA,OAAO,SAASmB,YAAYA,CAAA,EAAG;EAC3BC,YAAY,CAACC,UAAU,CAAC,UAAU,CAAC;EACnCD,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC,CAAC,CAAC;EACzCf,IAAI,GAAG,IAAI;EACXH,MAAM,CAACC,QAAQ,CAACkB,IAAI,GAAG,GAAG,CAAC,CAAC;AAChC;AAGA,eAAeX,YAAYA,CAACY,KAAa,EAAgB;EACrD,MAAMC,MAAM,GAAG,MAAMC,KAAK,CAAC,+BAA+B,EAAE;IACxDC,MAAM,EAAE,KAAK;IAAEC,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUL,KAAK;IAAG;EAC/D,CAAC,CAAC;EAEF,OAAO,MAAMC,MAAM,CAACK,IAAI,CAAC,CAAC;AAC9B;AAEA,SAASC,UAAUA,CAACtB,OAAoB,EAAE;EACtCQ,OAAO,CAACC,GAAG,CAACT,OAAO,CAACuB,YAAY,CAAC;EACjCC,QAAQ,CAACC,cAAc,CAAC,aAAa,CAAC,CAAEC,SAAS,GAAG1B,OAAO,CAACuB,YAAY;AAC5E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}