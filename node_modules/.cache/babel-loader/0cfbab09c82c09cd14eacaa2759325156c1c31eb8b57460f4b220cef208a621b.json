{"ast":null,"code":"import { redirectToAuthCodeFlow, getAccessToken } from \"./authCodeWithPkce\";\nconst clientId = \"e5f9bfa9d40447488e4fc74d2c71d293\";\nconst params = new URLSearchParams(window.location.search);\nlet code = params.get(\"code\");\nexport async function checkAuth() {\n  if (code) {\n    const accessToken = await getAccessToken(clientId, code);\n    const profile = await fetchProfile(accessToken);\n    sessionStorage.setItem(\"profile\", JSON.stringify(profile));\n    localStorage.setItem(\"accessToken\", accessToken);\n  }\n}\nexport async function handleLogin() {\n  if (!code) {\n    redirectToAuthCodeFlow(clientId);\n  }\n}\nexport async function auth() {\n  if (!code) {\n    redirectToAuthCodeFlow(clientId);\n  } else {\n    const accessToken = await getAccessToken(clientId, code);\n    const profile = await fetchProfile(accessToken);\n  }\n}\nexport function handleLogout() {\n  localStorage.removeItem(\"verifier\");\n  localStorage.removeItem(\"access_token\"); // If you store access token in localStorage\n  sessionStorage.removeItem(\"profile\");\n  code = null;\n  window.location.href = '/'; // Redirect to homepage or login page\n}\nexport async function fetchProfile(token) {\n  const result = await fetch(\"https://api.spotify.com/v1/me/\", {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  return await result.json();\n}\nexport async function fetchArtists(token) {\n  const result = await fetch(\"https://api.spotify.com/v1/me/\", {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  return await result.json();\n}","map":{"version":3,"names":["redirectToAuthCodeFlow","getAccessToken","clientId","params","URLSearchParams","window","location","search","code","get","checkAuth","accessToken","profile","fetchProfile","sessionStorage","setItem","JSON","stringify","localStorage","handleLogin","auth","handleLogout","removeItem","href","token","result","fetch","method","headers","Authorization","json","fetchArtists"],"sources":["C:/Users/Leo/Documents/learningts/my-app/src/scripts/auth.ts"],"sourcesContent":["import { redirectToAuthCodeFlow, getAccessToken } from \"./authCodeWithPkce\";\r\n\r\nconst clientId = \"e5f9bfa9d40447488e4fc74d2c71d293\";\r\nconst params = new URLSearchParams(window.location.search);\r\nlet code = params.get(\"code\");\r\n\r\nexport async function checkAuth() {\r\n    if (code){\r\n        const accessToken = await getAccessToken(clientId, code);\r\n        const profile = await fetchProfile(accessToken);\r\n        sessionStorage.setItem(\"profile\", JSON.stringify(profile));\r\n        localStorage.setItem(\"accessToken\", accessToken);\r\n    }\r\n}\r\n\r\nexport async function handleLogin() {\r\n    if (!code) {\r\n        redirectToAuthCodeFlow(clientId);\r\n    }\r\n}\r\n\r\nexport async function auth() {\r\n    if (!code) {\r\n        redirectToAuthCodeFlow(clientId);\r\n    } else {\r\n        const accessToken = await getAccessToken(clientId, code);\r\n        const profile = await fetchProfile(accessToken);\r\n    }\r\n}\r\n\r\nexport function handleLogout() {\r\n    localStorage.removeItem(\"verifier\");\r\n    localStorage.removeItem(\"access_token\"); // If you store access token in localStorage\r\n    sessionStorage.removeItem(\"profile\")\r\n    code = null;\r\n    window.location.href = '/'; // Redirect to homepage or login page\r\n}\r\n\r\n\r\nexport async function fetchProfile(token: string): Promise<any> {\r\n    const result = await fetch(\"https://api.spotify.com/v1/me/\", {\r\n        method: \"GET\", headers: { Authorization: `Bearer ${token}` }\r\n    });\r\n\r\n    return await result.json();\r\n}\r\n\r\nexport async function fetchArtists(token: string): Promise<any> {\r\n    const result = await fetch(\"https://api.spotify.com/v1/me/\", {\r\n        method: \"GET\", headers: { Authorization: `Bearer ${token}` }\r\n    });\r\n\r\n    return await result.json();\r\n}\r\n\r\n"],"mappings":"AAAA,SAASA,sBAAsB,EAAEC,cAAc,QAAQ,oBAAoB;AAE3E,MAAMC,QAAQ,GAAG,kCAAkC;AACnD,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;AAC1D,IAAIC,IAAI,GAAGL,MAAM,CAACM,GAAG,CAAC,MAAM,CAAC;AAE7B,OAAO,eAAeC,SAASA,CAAA,EAAG;EAC9B,IAAIF,IAAI,EAAC;IACL,MAAMG,WAAW,GAAG,MAAMV,cAAc,CAACC,QAAQ,EAAEM,IAAI,CAAC;IACxD,MAAMI,OAAO,GAAG,MAAMC,YAAY,CAACF,WAAW,CAAC;IAC/CG,cAAc,CAACC,OAAO,CAAC,SAAS,EAAEC,IAAI,CAACC,SAAS,CAACL,OAAO,CAAC,CAAC;IAC1DM,YAAY,CAACH,OAAO,CAAC,aAAa,EAAEJ,WAAW,CAAC;EACpD;AACJ;AAEA,OAAO,eAAeQ,WAAWA,CAAA,EAAG;EAChC,IAAI,CAACX,IAAI,EAAE;IACPR,sBAAsB,CAACE,QAAQ,CAAC;EACpC;AACJ;AAEA,OAAO,eAAekB,IAAIA,CAAA,EAAG;EACzB,IAAI,CAACZ,IAAI,EAAE;IACPR,sBAAsB,CAACE,QAAQ,CAAC;EACpC,CAAC,MAAM;IACH,MAAMS,WAAW,GAAG,MAAMV,cAAc,CAACC,QAAQ,EAAEM,IAAI,CAAC;IACxD,MAAMI,OAAO,GAAG,MAAMC,YAAY,CAACF,WAAW,CAAC;EACnD;AACJ;AAEA,OAAO,SAASU,YAAYA,CAAA,EAAG;EAC3BH,YAAY,CAACI,UAAU,CAAC,UAAU,CAAC;EACnCJ,YAAY,CAACI,UAAU,CAAC,cAAc,CAAC,CAAC,CAAC;EACzCR,cAAc,CAACQ,UAAU,CAAC,SAAS,CAAC;EACpCd,IAAI,GAAG,IAAI;EACXH,MAAM,CAACC,QAAQ,CAACiB,IAAI,GAAG,GAAG,CAAC,CAAC;AAChC;AAGA,OAAO,eAAeV,YAAYA,CAACW,KAAa,EAAgB;EAC5D,MAAMC,MAAM,GAAG,MAAMC,KAAK,CAAC,gCAAgC,EAAE;IACzDC,MAAM,EAAE,KAAK;IAAEC,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUL,KAAK;IAAG;EAC/D,CAAC,CAAC;EAEF,OAAO,MAAMC,MAAM,CAACK,IAAI,CAAC,CAAC;AAC9B;AAEA,OAAO,eAAeC,YAAYA,CAACP,KAAa,EAAgB;EAC5D,MAAMC,MAAM,GAAG,MAAMC,KAAK,CAAC,gCAAgC,EAAE;IACzDC,MAAM,EAAE,KAAK;IAAEC,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUL,KAAK;IAAG;EAC/D,CAAC,CAAC;EAEF,OAAO,MAAMC,MAAM,CAACK,IAAI,CAAC,CAAC;AAC9B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}