{"ast":null,"code":"export async function fetchProfile(code) {\n  const result = await fetch(\"https://api.spotify.com/v1/me\", {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${code}`\n    }\n  });\n  return await result.json();\n}\nexport async function fetchArtists(code, termIndex) {\n  const terms = [\"short_term\", \"medium_term\", \"long_term\"];\n  const result = await fetch(`https://api.spotify.com/v1/me/top/artists?time_range=${terms[termIndex]}&limit=50`, {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${code}`\n    }\n  });\n  return await result.json();\n}\nexport async function fetchTracks(code, termIndex) {\n  const terms = [\"short_term\", \"medium_term\", \"long_term\"];\n  const result = await fetch(`https://api.spotify.com/v1/me/top/tracks?time_range=${terms[termIndex]}&limit=50`, {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${code}`\n    }\n  });\n  return await result.json();\n}\nexport function fetchRecommendations(code) {\n  const wait = ms => new Promise(resolve => setTimeout(resolve, ms));\n  return fetchArtists(code, 2).then(artists => wait(30000).then(() => artists)).then(artists => {\n    const artistIds = artists.items.slice(0, 2).map(artist => artist.id);\n    const seed_artists = artistIds.join(\",\");\n    return fetchTracks(code, 1).then(tracks => wait(30000).then(() => ({\n      seed_artists,\n      tracks\n    })));\n  }).then(({\n    seed_artists,\n    tracks\n  }) => {\n    const randomIndex = Math.floor(Math.random() * 20);\n    const seed_track = tracks.items[randomIndex].id;\n    return wait(30000).then(() => ({\n      seed_artists,\n      seed_track\n    }));\n  }).then(({\n    seed_artists,\n    seed_track\n  }) => {\n    return fetch(`https://api.spotify.com/v1/recommendations?seed_artists=${seed_artists}&seed_genres=latino%2Chouse&seed_tracks=${seed_track}`, {\n      method: \"GET\",\n      headers: {\n        Authorization: `Bearer ${code}`\n      }\n    });\n  }).then(response => response.json());\n}","map":{"version":3,"names":["fetchProfile","code","result","fetch","method","headers","Authorization","json","fetchArtists","termIndex","terms","fetchTracks","fetchRecommendations","wait","ms","Promise","resolve","setTimeout","then","artists","artistIds","items","slice","map","artist","id","seed_artists","join","tracks","randomIndex","Math","floor","random","seed_track","response"],"sources":["C:/Users/Leo/Documents/learningts/my-app/src/scripts/APIscript.ts"],"sourcesContent":["export async function fetchProfile(code: string): Promise<UserProfile> {\r\n  const result = await fetch(\"https://api.spotify.com/v1/me\", {\r\n    method: \"GET\",\r\n    headers: { Authorization: `Bearer ${code}` },\r\n  });\r\n\r\n  return await result.json();\r\n}\r\n\r\nexport async function fetchArtists(code: string, termIndex : number): Promise<any> {\r\n  const terms = [\"short_term\", \"medium_term\", \"long_term\"];\r\n  const result = await fetch(\r\n    `https://api.spotify.com/v1/me/top/artists?time_range=${terms[termIndex]}&limit=50`,\r\n    {\r\n      method: \"GET\",\r\n      headers: {\r\n        Authorization: `Bearer ${code}`,\r\n      },\r\n    }\r\n  );\r\n\r\n  return await result.json();\r\n}\r\n\r\nexport async function fetchTracks(code: string, termIndex : number): Promise<any> {\r\n  const terms = [\"short_term\", \"medium_term\", \"long_term\"];\r\n  const result = await fetch(`https://api.spotify.com/v1/me/top/tracks?time_range=${terms[termIndex]}&limit=50`, {\r\n    method: \"GET\",\r\n    headers: { Authorization: `Bearer ${code}` },\r\n  });\r\n\r\n  return await result.json();\r\n}\r\n\r\nexport function fetchRecommendations(code: string): Promise<any> {\r\n  const wait = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\r\n\r\n  return fetchArtists(code, 2)\r\n    .then(artists => wait(30000).then(() => artists))\r\n    .then(artists => {\r\n      const artistIds = artists.items.slice(0, 2).map((artist: any) => artist.id);\r\n      const seed_artists = artistIds.join(\",\");\r\n\r\n      return fetchTracks(code, 1).then(tracks => wait(30000).then(() => ({ seed_artists, tracks })));\r\n    })\r\n    .then(({ seed_artists, tracks }) => {\r\n      const randomIndex = Math.floor(Math.random() * 20);\r\n      const seed_track = tracks.items[randomIndex].id;\r\n\r\n      return wait(30000).then(() => ({ seed_artists, seed_track }));\r\n    })\r\n    .then(({ seed_artists, seed_track }) => {\r\n      return fetch(\r\n        `https://api.spotify.com/v1/recommendations?seed_artists=${seed_artists}&seed_genres=latino%2Chouse&seed_tracks=${seed_track}`,\r\n        {\r\n          method: \"GET\",\r\n          headers: { Authorization: `Bearer ${code}` },\r\n        }\r\n      );\r\n    })\r\n    .then(response => response.json());\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}